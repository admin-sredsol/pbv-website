---
import BaseLayout from "../layouts/BaseLayout.astro";
import MediaCard from "../components/gallery/MediaCard.astro";
import InnerHero from "../components/sections/InnerHero.astro";
import { listR2Files } from "../utils/r2";

const bucket = "website-gallery";
let videos = await listR2Files(bucket, "videos/");
videos = videos.filter((video) => !video.key.endsWith("/"));
import heroBg from "../assets/InnerHero-bg.jpg"; // adjust path as needed
---

<BaseLayout>
    <InnerHero
        content={{
            title: "Videos",
            description: "A collection of our best video moments.",
            backgroundImage: heroBg,
            overlayOpacity: 0.6,
        }}
    />

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 py-24">
        {
            videos.map((video) => {
                // Create a readable label from the filename
                const label = video.key
                    .replace(/^videos\//, "")
                    .replace(/\.[^/.]+$/, "")
                    .replace(/[-_]/g, " ");
                return (
                    <MediaCard
                        type="video"
                        src={video.url}
                        title={label}
                        aspect="aspect-video"
                        className="bg-white shadow rounded-lg"
                    />
                );
            })
        }
    </div>
</BaseLayout>
