---
import Eyebrow from "../ui/Eyebrow.astro";
import {
    getBackgroundColor,
    getTextColor,
    getHeadlineColor,
} from "../../utils/styleUtils";
import type { ThemeColor } from "../../utils/styleUtils";

export interface Testimonial {
    name: string;
    role: string;
    image: string;
    title: string;
    quotes: string[];
}

const {
    testimonials = [],
    heading = "Testimonials",
    description = "Explore the whole collection of open-source web components and elements built with the utility classes from Tailwind",
    showMoreHref = "#",
    showMoreLabel = "Show more...",
    background = "base", // new prop for theme color
    eyebrow, // optional: pass { text: "Section label", background: "base" }
    cardBackground, // optional, defaults to background
    cardText, // optional, defaults to background
    cardHeadline, // optional, defaults to background
} = Astro.props;

const sectionBg = getBackgroundColor(background);
const textColor = getTextColor(background);
const headlineColor = getHeadlineColor(background);

const cardBg = getBackgroundColor(cardBackground ?? background);
const cardTextColor = getTextColor(cardText ?? background);
const cardHeadlineColor = getHeadlineColor(cardHeadline ?? background);
---

<section class={sectionBg}>
    <div class="py-8 px-4 mx-auto max-w-screen-xl text-center lg:py-16 lg:px-6">
        <div class="mx-auto max-w-screen-sm">
            {
                eyebrow && (
                    <Eyebrow
                        text={eyebrow.text}
                        background={eyebrow.background ?? background}
                    />
                )
            }
            <h2
                class={`mb-4 text-4xl tracking-tight font-extrabold ${headlineColor}`}
            >
                {heading}
            </h2>
            <p class={`mb-8 font-light lg:mb-16 sm:text-xl ${textColor}`}>
                {description}
            </p>
        </div>
        <div class="grid mb-8 lg:mb-12 lg:grid-cols-2">
            {
                testimonials.map((t, i) => (
                    <figure
                        class={`flex flex-col justify-center items-center p-8 text-center border-b border-gray-200 md:p-12 ${i % 2 === 0 ? "lg:border-r" : ""} ${cardBg}`}
                    >
                        <blockquote
                            class={`mx-auto mb-8 max-w-2xl ${cardTextColor}`}
                        >
                            <h3
                                class={`text-lg font-semibold ${cardHeadlineColor}`}
                            >
                                {t.title}
                            </h3>
                            {t.quotes.map((q) => (
                                <p class="my-4">{q}</p>
                            ))}
                        </blockquote>
                        <figcaption class="flex justify-center items-center space-x-3">
                            <img
                                class="w-9 h-9 rounded-full"
                                src={t.image}
                                alt="profile picture"
                            />
                            <div
                                class={`space-y-0.5 font-medium text-left ${cardHeadlineColor}`}
                            >
                                <div>{t.name}</div>
                                <div
                                    class={`text-sm font-light ${cardTextColor}`}
                                >
                                    {t.role}
                                </div>
                            </div>
                        </figcaption>
                    </figure>
                ))
            }
        </div>
        <div class="text-center">
            <a
                href={showMoreHref}
                class={`py-2.5 px-5 mr-2 mb-2 text-sm font-medium focus:outline-none rounded-lg border hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 ${textColor} ${sectionBg}`}
                >{showMoreLabel}</a
            >
        </div>
    </div>
</section>
